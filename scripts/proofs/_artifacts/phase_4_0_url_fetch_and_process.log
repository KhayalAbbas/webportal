=== PHASE 4.0 URL FETCH + PROCESS PROOF ===
API Base: http://localhost:8005
Tenant: b3909011-8bd3-439d-a421-3b70fae124e9
--- PRE-FLIGHT ---
Python: 3.11.9 (tags/v3.11.9:de54cf5, Apr  2 2024, 10:12:12) [MSC v.1938 64 bit (AMD64)]
git status -sb (C:/Program Files/Git/cmd/git.exe): ## master...origin/master
 M app/models/company_research.py
 M app/repositories/company_research_repo.py
 M app/schemas/company_research.py
 M app/services/company_extraction_service.py
 M app/services/company_research_service.py
 M app/workers/company_research_worker.py
 M scripts/proofs/_artifacts/phase_4_0_preflight.txt
?? alembic/versions/e54d1fa8c93a_add_http_metadata_and_retry_cap.py
?? scripts/proofs/phase_4_1_url_retry_and_http_meta.py
alembic current: e54d1fa8c93a (head)
alembic heads: e54d1fa8c93a (head)
Preflight saved to scripts\proofs\_artifacts\phase_4_0_preflight.txt
--- PRE-FLIGHT DONE ---
Starting local uvicorn for proof...
Run created: 057b8724-2be1-4f3c-bed2-80c82e956254
URL sources attached: good=3e7473b9-cda0-4bae-9e86-d2e5607500b2 bad=ad808184-174f-4785-9486-52b418f85b8c
Run started (job 38077dd5-38d1-4c82-b16a-a8cc8f8011f0)
After worker pass 1: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 2: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 3: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 4: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 5: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 6: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 7: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 8: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 9: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 10: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 11: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 12: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 13: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 14: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 15: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 16: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 17: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 18: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 19: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 20: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 21: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 22: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 23: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 24: {'fetch_url_sources': 'failed', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 25: {'fetch_url_sources': 'succeeded', 'process_sources': 'pending', 'finalize': 'pending'}
After worker pass 26: {'fetch_url_sources': 'succeeded', 'process_sources': 'succeeded', 'finalize': 'pending'}
After worker pass 27: {'fetch_url_sources': 'succeeded', 'process_sources': 'succeeded', 'finalize': 'succeeded'}
Sources endpoint snapshot:
 - https://nonexistent.invalid/: status=failed attempts=3 last_error=Failed to fetch URL: [Errno 11001] getaddrinfo failed next_retry=2026-01-03T06:02:11.188926Z
 - https://example.com/: status=fetched attempts=1 last_error=None next_retry=None
Recent events (API):
 - fetch_failed status=failed at 2026-01-03T06:00:40.945550Z
 - fetch_started status=ok at 2026-01-03T06:00:40.938105Z
 - fetch_failed status=failed at 2026-01-03T05:59:38.506807Z
 - fetch_started status=ok at 2026-01-03T05:59:38.500777Z
 - fetch_failed status=failed at 2026-01-03T05:58:59.922466Z
 - fetch_started status=ok at 2026-01-03T05:58:59.917822Z
 - fetch_succeeded status=ok at 2026-01-03T05:58:59.645881Z
 - fetch_started status=ok at 2026-01-03T05:58:59.641543Z
next_retry_at (bad)=2026-01-03T06:02:11.188926+00:00 db_now=2026-01-03T06:00:56.843675+00:00
DB sources snapshot:
 - https://example.com/ status=fetched attempts=1 next_retry=None fetched_at=2026-01-03 05:58:59.913114+00:00 hash=e639c656ee40993c86c194936ccd14fb20b5c9d483d5b49d90e3246a8a2b87d3
 - https://nonexistent.invalid/ status=failed attempts=3 next_retry=2026-01-03 06:02:11.188926+00:00 fetched_at=None hash=None
Idempotency verified: no new fetch events and attempts unchanged on re-run